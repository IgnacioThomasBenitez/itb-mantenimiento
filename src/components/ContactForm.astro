<form id="contactForm" style="max-width: 42rem; margin: 0 auto; background-color: var(--color-itb-gray-dark); padding: 2rem; border-radius: 0.5rem; border: 2px solid var(--color-itb-gray);">
  <div style="margin-bottom: 1.5rem;">
    <label for="name" style="display: block; color: var(--color-itb-gray-light); margin-bottom: 0.5rem; font-weight: 500;">Nombre Completo</label>
    <input 
      type="text" 
      id="name" 
      name="name" 
      required
      style="width: 100%; padding: 0.75rem 1rem; background-color: var(--color-itb-black); border: 2px solid var(--color-itb-gray); border-radius: 0.5rem; color: white; font-family: inherit; font-size: 1rem;"
      onfocus="this.style.borderColor='var(--color-itb-pink)'; this.style.outline='none';"
      onblur="this.style.borderColor='var(--color-itb-gray)';"
    >
  </div>

  <div style="margin-bottom: 1.5rem;">
    <label for="email" style="display: block; color: var(--color-itb-gray-light); margin-bottom: 0.5rem; font-weight: 500;">Email</label>
    <input 
      type="email" 
      id="email" 
      name="email" 
      required
      style="width: 100%; padding: 0.75rem 1rem; background-color: var(--color-itb-black); border: 2px solid var(--color-itb-gray); border-radius: 0.5rem; color: white; font-family: inherit; font-size: 1rem;"
      onfocus="this.style.borderColor='var(--color-itb-pink)'; this.style.outline='none';"
      onblur="this.style.borderColor='var(--color-itb-gray)';"
    >
  </div>

  <div style="margin-bottom: 1.5rem;">
    <label for="phone" style="display: block; color: var(--color-itb-gray-light); margin-bottom: 0.5rem; font-weight: 500;">Telefono</label>
    <input 
      type="tel" 
      id="phone" 
      name="phone"
      style="width: 100%; padding: 0.75rem 1rem; background-color: var(--color-itb-black); border: 2px solid var(--color-itb-gray); border-radius: 0.5rem; color: white; font-family: inherit; font-size: 1rem;"
      onfocus="this.style.borderColor='var(--color-itb-pink)'; this.style.outline='none';"
      onblur="this.style.borderColor='var(--color-itb-gray)';"
    >
  </div>

  <div style="margin-bottom: 1.5rem;">
    <label for="service" style="display: block; color: var(--color-itb-gray-light); margin-bottom: 0.5rem; font-weight: 500;">Servicio</label>
    <select 
      id="service" 
      name="service"
      required
      style="width: 100%; padding: 0.75rem 1rem; background-color: var(--color-itb-black); border: 2px solid var(--color-itb-gray); border-radius: 0.5rem; color: white; font-family: inherit; font-size: 1rem;"
      onfocus="this.style.borderColor='var(--color-itb-pink)'; this.style.outline='none';"
      onblur="this.style.borderColor='var(--color-itb-gray)';"
    >
      <option value="">Selecciona un servicio</option>
      <option value="hardware">Reparacion Hardware</option>
      <option value="software">Instalacion de Software</option>
      <option value="mantenimiento">Mantenimiento Preventivo</option>
      <option value="formateo">Formateo e Instalacion SO</option>
      <option value="otro">Otro</option>
    </select>
  </div>

  <div style="margin-bottom: 1.5rem;">
    <label for="message" style="display: block; color: var(--color-itb-gray-light); margin-bottom: 0.5rem; font-weight: 500;">Mensaje</label>
    <textarea 
      id="message" 
      name="message" 
      rows="5"
      required
      style="width: 100%; padding: 0.75rem 1rem; background-color: var(--color-itb-black); border: 2px solid var(--color-itb-gray); border-radius: 0.5rem; color: white; resize: none; font-family: inherit; font-size: 1rem;"
      onfocus="this.style.borderColor='var(--color-itb-pink)'; this.style.outline='none';"
      onblur="this.style.borderColor='var(--color-itb-gray)';"
    ></textarea>
  </div>

  <button 
    type="submit"
    style="width: 100%; background-color: var(--color-itb-pink); color: white; padding: 0.75rem; border-radius: 0.5rem; font-weight: 600; border: none; cursor: pointer; font-size: 1rem; transition: all 0.3s ease;"
    onmouseover="this.style.backgroundColor='var(--color-itb-pink-dark)'; this.style.transform='scale(1.05)';"
    onmouseout="this.style.backgroundColor='var(--color-itb-pink)'; this.style.transform='scale(1)';"
  >
    Enviar Mensaje
  </button>

  <p id="statusMessage" style="margin-top:1rem; color: var(--color-itb-gray-light); text-align: center; display:none;"></p>
</form>

<script is:inline>
  // Esperar a que EmailJS se cargue
  function initContactForm() {
    // Verificar que EmailJS esté disponible
    if (typeof emailjs === 'undefined') {
      console.error('EmailJS no esta cargado');
      setTimeout(initContactForm, 100);
      return;
    }

    // Inicializar EmailJS
    emailjs.init("0mfER7R_j1KtnPMs8");

    const form = document.getElementById("contactForm");
    const statusMessage = document.getElementById("statusMessage");

    if (form && !form.dataset.initialized) {
      form.dataset.initialized = "true";
      
      form.addEventListener("submit", async function(e) {
        e.preventDefault();

        const nombre = form.name.value.trim();
        const email = form.email.value.trim();
        const phone = form.phone.value.trim();
        const service = form.service.value;
        const message = form.message.value.trim();

        if (!nombre || !email || !service || !message) {
          statusMessage.style.display = "block";
          statusMessage.style.color = "#ef4444";
          statusMessage.textContent = "Por favor, completa todos los campos obligatorios.";
          return;
        }

        // Mostrar mensaje de envio
        statusMessage.style.display = "block";
        statusMessage.style.color = "var(--color-itb-gray-light)";
        statusMessage.textContent = "⏳ Enviando mensaje...";

        const templateParams = {
          nombre: nombre,
          email: email,
          phone: phone,
          service: service,
          message: message,
          fecha: new Date().toLocaleString("es-AR")
        };

        try {
          await emailjs.send(
            "service_q180ty5",
            "template_05e5l88",
            templateParams
          );

          statusMessage.style.color = "#22c55e";
          statusMessage.textContent = "✅ Mensaje enviado con exito!";
          form.reset();
          
          setTimeout(function() {
            statusMessage.style.display = "none";
          }, 5000);
        } catch (error) {
          console.error("Error enviando el email:", error);
          statusMessage.style.color = "#ef4444";
          statusMessage.textContent = "❌ Error al enviar el mensaje. Intenta nuevamente.";
        }
      });
    }
  }

  // Cargar EmailJS y luego inicializar el formulario
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', function() {
      const script = document.createElement('script');
      script.src = 'https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js';
      script.onload = initContactForm;
      document.head.appendChild(script);
    });
  } else {
    const script = document.createElement('script');
    script.src = 'https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js';
    script.onload = initContactForm;
    document.head.appendChild(script);
  }
</script>